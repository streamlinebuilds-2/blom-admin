<!DOCTYPE html>
<html>
<head>
    <title>Direct Variant Addition</title>
</head>
<body>
    <h1>Adding Sweet Peach variant to Core Acrylics...</h1>
    <div id="status">Starting...</div>

    <script>
        // Direct variant addition using browser fetch
        async function addVariant() {
            const statusDiv = document.getElementById('status');
            
            try {
                statusDiv.innerHTML = 'üîç Finding Core Acrylics product...';
                
                // Step 1: Find the product
                const findResponse = await fetch('https://blom-admin.netlify.app/.netlify/functions/admin-product?slug=core-acrylics');
                
                if (!findResponse.ok) {
                    throw new Error(`Product not found: ${findResponse.status}`);
                }
                
                const findData = await findResponse.json();
                const product = findData.product;
                
                if (!product) {
                    throw new Error('Product data not found');
                }
                
                statusDiv.innerHTML = `‚úÖ Found product: ${product.name} (ID: ${product.id})`;
                
                // Step 2: Add the variant
                const newVariant = {
                    name: "Sweet Peach",
                    image: "https://res.cloudinary.com/dnlgohkcc/image/upload/v1763740353/peach-cuticile_pd063t.jpg"
                };
                
                const updatedVariants = [...(product.variants || []), newVariant];
                
                const updateData = {
                    id: product.id,
                    partial_update: true,
                    variants: updatedVariants
                };
                
                statusDiv.innerHTML = 'üìù Adding Sweet Peach variant...';
                
                const saveResponse = await fetch('https://blom-admin.netlify.app/.netlify/functions/save-product', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updateData),
                });
                
                const saveResult = await saveResponse.json();
                
                if (saveResponse.ok && saveResult.ok) {
                    statusDiv.innerHTML = `
                        üéâ <strong>SUCCESS!</strong><br>
                        Added "Sweet Peach" variant to ${product.name}<br>
                        Total variants: ${saveResult.product.variants?.length || 'unknown'}
                    `;
                    console.log('‚úÖ Success!', saveResult);
                } else {
                    throw new Error(saveResult.error || 'Update failed');
                }
                
            } catch (error) {
                statusDiv.innerHTML = `
                    ‚ùå <strong>Error:</strong> ${error.message}<br>
                    <small>Check browser console for details</small>
                `;
                console.error('Error:', error);
            }
        }
        
        // Auto-start
        addVariant();
    </script>
</body>
</html>